{"version":3,"file":"DevelopmentTeam.js","names":["_Target","data","require","_Xcodeproj","_string","_iosPlugins","withAppleDevelopmentTeam","config","developmentTeam","withXcodeProject","teamId","ios","modResults","updateDevelopmentTeamForPbxproj","exports","getDevelopmentTeamFromBuildConfiguration","xcBuildConfiguration","buildSettings","DEVELOPMENT_TEAM","trimQuotes","setDevelopmentTeamForBuildConfiguration","project","nativeTarget","findFirstNativeTarget","getBuildConfigurationsForListId","buildConfigurationList","forEach","buildConfig"],"sources":["../../src/ios/DevelopmentTeam.ts"],"sourcesContent":["import type { XCBuildConfiguration } from 'xcode';\n\nimport { findFirstNativeTarget } from './Target';\nimport { getBuildConfigurationsForListId } from './utils/Xcodeproj';\nimport { trimQuotes } from './utils/string';\nimport type { ConfigPlugin, XcodeProject } from '../Plugin.types';\nimport { withXcodeProject } from '../plugins/ios-plugins';\n\n/**\n * Set the Apple development team ID for all build configurations using the first native target.\n */\nexport const withAppleDevelopmentTeam: ConfigPlugin<{ developmentTeam?: string } | void> = (\n  config,\n  { developmentTeam } = {}\n) => {\n  return withXcodeProject(config, (config) => {\n    // TODO: maybe infer from `EXPO_APPLE_TEAM_ID` env variable?\n    // @ts-expect-error TODO: add to config types\n    const teamId = developmentTeam ?? config.ios?.developmentTeam;\n    if (teamId) {\n      config.modResults = updateDevelopmentTeamForPbxproj(config.modResults, teamId);\n    }\n\n    return config;\n  });\n};\n\n/** Get the Apple development team ID from an XCBuildConfiguration object */\nexport function getDevelopmentTeamFromBuildConfiguration(\n  xcBuildConfiguration: XCBuildConfiguration\n): string | null {\n  const developmentTeam = xcBuildConfiguration.buildSettings.DEVELOPMENT_TEAM;\n  if (developmentTeam) {\n    return trimQuotes(developmentTeam);\n  }\n\n  return null;\n}\n\n/** Set the Apple development team ID for an XCBuildConfiguration object */\nexport function setDevelopmentTeamForBuildConfiguration(\n  xcBuildConfiguration: XCBuildConfiguration,\n  developmentTeam?: string\n): void {\n  if (developmentTeam) {\n    xcBuildConfiguration.buildSettings.DEVELOPMENT_TEAM = `${developmentTeam}`;\n  } else {\n    delete xcBuildConfiguration.buildSettings.DEVELOPMENT_TEAM;\n  }\n}\n\n/**\n * Update the Apple development team ID for all XCBuildConfiguration entries using the first native target\n *\n * A development team is stored as a value in XCBuildConfiguration entry.\n * Those entries exist for every pair (build target, build configuration).\n * Unless target name is passed, the first target defined in the pbxproj is used\n * (to keep compatibility with the inaccurate legacy implementation of this function).\n */\nexport function updateDevelopmentTeamForPbxproj(\n  project: XcodeProject,\n  developmentTeam?: string\n): XcodeProject {\n  const [, nativeTarget] = findFirstNativeTarget(project);\n\n  getBuildConfigurationsForListId(project, nativeTarget.buildConfigurationList).forEach(\n    ([, buildConfig]) => setDevelopmentTeamForBuildConfiguration(buildConfig, developmentTeam)\n  );\n\n  return project;\n}\n"],"mappings":";;;;;;;;;AAEA,SAAAA,QAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,OAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAE,WAAA;EAAA,MAAAF,IAAA,GAAAC,OAAA;EAAAC,UAAA,YAAAA,CAAA;IAAA,OAAAF,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AACA,SAAAG,QAAA;EAAA,MAAAH,IAAA,GAAAC,OAAA;EAAAE,OAAA,YAAAA,CAAA;IAAA,OAAAH,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAEA,SAAAI,YAAA;EAAA,MAAAJ,IAAA,GAAAC,OAAA;EAAAG,WAAA,YAAAA,CAAA;IAAA,OAAAJ,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAEA;AACA;AACA;AACO,MAAMK,wBAA2E,GAAGA,CACzFC,MAAM,EACN;EAAEC;AAAgB,CAAC,GAAG,CAAC,CAAC,KACrB;EACH,OAAO,IAAAC,8BAAgB,EAACF,MAAM,EAAGA,MAAM,IAAK;IAC1C;IACA;IACA,MAAMG,MAAM,GAAGF,eAAe,IAAID,MAAM,CAACI,GAAG,EAAEH,eAAe;IAC7D,IAAIE,MAAM,EAAE;MACVH,MAAM,CAACK,UAAU,GAAGC,+BAA+B,CAACN,MAAM,CAACK,UAAU,EAAEF,MAAM,CAAC;IAChF;IAEA,OAAOH,MAAM;EACf,CAAC,CAAC;AACJ,CAAC;;AAED;AAAAO,OAAA,CAAAR,wBAAA,GAAAA,wBAAA;AACO,SAASS,wCAAwCA,CACtDC,oBAA0C,EAC3B;EACf,MAAMR,eAAe,GAAGQ,oBAAoB,CAACC,aAAa,CAACC,gBAAgB;EAC3E,IAAIV,eAAe,EAAE;IACnB,OAAO,IAAAW,oBAAU,EAACX,eAAe,CAAC;EACpC;EAEA,OAAO,IAAI;AACb;;AAEA;AACO,SAASY,uCAAuCA,CACrDJ,oBAA0C,EAC1CR,eAAwB,EAClB;EACN,IAAIA,eAAe,EAAE;IACnBQ,oBAAoB,CAACC,aAAa,CAACC,gBAAgB,GAAI,GAAEV,eAAgB,EAAC;EAC5E,CAAC,MAAM;IACL,OAAOQ,oBAAoB,CAACC,aAAa,CAACC,gBAAgB;EAC5D;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASL,+BAA+BA,CAC7CQ,OAAqB,EACrBb,eAAwB,EACV;EACd,MAAM,GAAGc,YAAY,CAAC,GAAG,IAAAC,+BAAqB,EAACF,OAAO,CAAC;EAEvD,IAAAG,4CAA+B,EAACH,OAAO,EAAEC,YAAY,CAACG,sBAAsB,CAAC,CAACC,OAAO,CACnF,CAAC,GAAGC,WAAW,CAAC,KAAKP,uCAAuC,CAACO,WAAW,EAAEnB,eAAe,CAC3F,CAAC;EAED,OAAOa,OAAO;AAChB"}